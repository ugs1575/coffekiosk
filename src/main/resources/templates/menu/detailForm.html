<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head th:replace="~{fragments/common :: head('게시판')}"> </head>
    <body>
        <nav
            class="navbar navbar-expand-md navbar-dark bg-dark fixed-top"
            th:replace="~{fragments/common :: menu('order')}"
        ></nav>

        <div class="container">
            <form th:object="${item}" th:action="@{/cart/list}" method="POST" onsubmit="return goToCart();">
                <h1 style="margin-bottom:50px">메뉴 상세</h1>
                <div class="form-group">
                    <label th:for="name">상품명</label>
                    <input type="text" class="form-control" th:field="*{name}" disabled/>
                </div>
                <div class="form-group">
                    <label th:for="itemType">상품타입</label>
                    <input type="text" class="form-control" th:field="*{itemType.name}" disabled/>
                </div>
                <div class="form-group">
                    <label th:for="itemType">가격</label>
                    <input type="text" class="form-control" th:field="*{price}" disabled/>
                </div>
                <div class="form-group text-center">
                    <label th:for="itemType" style="margin-right:20px">수량</label>
                    <button type="button" id="minus" class="btn btn-outline-dark" style="margin-right:10px" disabled>-</button>
                    <input type="hidden" class="form-control" id="count" name="count" value="1"/>
                    <span id="orderCount">1</span>
                    <button type="button" id="plus" class="btn btn-outline-dark" style="margin-left:10px">+</button>
                </div>
                <div class="text-center">
                    <a type="button" class="btn btn-secondary" th:href="@{/menu/list}">
                        취소
                    </a>
                    <button type="submit" class="btn btn-info">
                        담기
                    </button>
                    <a type="button" class="btn btn-success" th:href="@{/cart/list}">
                        주문하기
                    </a>
                </div>
            </form>
        </div>
    </body>
</html>

<script>
$(document).ready(function(){
    updateOrderCount();

    function updateOrderCount() {
        $("#plus").click(function(){
            var count = parseInt($('#count').val());
            count += 1;

            if (count == 20) {
                $(('#plus')).attr('disabled', 'disabled');
            } else if (count == 2) {
                $(('#minus')).removeAttr('disabled');
            }

            $('#count').val(count);
            $('#orderCount').text(count);
        });

        $("#minus").click(function(){
            var count = parseInt($('#count').val());
            count -= 1;

            if (count == 1) {
                $(('#minus')).attr('disabled', 'disabled');
            } else if (count == 19) {
                $(('#plus')).removeAttr('disabled');
            }

            $('#count').val(count);
            $('#orderCount').text(count);
        });
    }
});

function goToCart() {
    //ajax add cart call if success
    if (confirm("장바구니에 추가되었습니다. 장바구니로 이동하시겠습니까?")) {
        return true;
    }

    return false;
}
</script>
